---
title: "| Survival Analysis    \n| Data Wrangling & Feature Engineering\n"
author: "April Leclair"
date: "2018-02-11"
output:
  bookdown::tufte_html2:
    number_sections: no
    split_by: none
    toc: no
  bookdown::pdf_document2:
    latex_engine: pdflatex
    number_sections: no
    toc: no
  bookdown::tufte_handout2:
    latex_engine: xelatex
    number_sections: no
    toc: no
  bookdown::html_document2:
    number_sections: no
    split_by: none
    toc: no
---
 
```{r setup, include=FALSE, message=FALSE}
library(tidyverse)
library(readr)
knitr::opts_chunk$set(tidy = FALSE, message=FALSE, cache.extra = packageVersion('tufte'))
options(htmltools.dir.version = FALSE)
```

# Load Data 
```{r message=FALSE, warning=FALSE}
houseTC_final <- read_csv("../Source/houseTC_final.csv")
```

# Variable Names
```{r}
names(houseTC)
names(houseTC_final)
```

# Feature Engineering

### Time on Market `tom`, Price Difference `pdiff`, & Price Difference in Percentage `pdiff_perc`
```{r}
tem <- houseTC_final

tem2 <- tem %>%
  mutate(tom = soldatdate - listedatdate,
         prdiff = soldatpr - listedatpr,
         prdiff_perc = (soldatpr - listedatpr)/listedatpr)
  
tem2 %>%
  arrange(desc(tom))

tem2 %>%
  arrange(tom)


tem2 %>%
  arrange(desc(prdiff))

tem2 %>%
  arrange(tom)


tem3 <- tem2 %>%
  mutate(prdiff_np = ifelse(prdiff > 0, 1, 
                            ifelse(prdiff < 0, -1,
                                   ifelse(prdiff == 0, 0, 5))))

table(tem3$prdiff_np)


mean(tem3$prdiff)
plot(tem3$prdiff, tem3$tom)
plot(tem3$prdiff_np, tem3$tom)
```
